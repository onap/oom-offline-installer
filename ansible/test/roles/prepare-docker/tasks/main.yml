---
- name: Check repositories
  stat:
    path: "{{ item }}"
  loop: "{{ docker_needed_repos + [offline_repo_file] }}"
  register: repos

- name: Set fact for offline repos created
  set_fact:
    offline_repo_created: "{{ (repos.results | map(attribute='stat.exists') | list) is all }}"

- debug:
    var: offline_repo_created

- name: Enable repos back (if package-repository role already setup offline onap repo) for molecule testing purposes to install docker
  include_tasks: enable-repos.yml
  when: offline_repo_created

- name: Prepare docker repos normally
  include_tasks: prepare-docker-repos.yml
  when: not offline_repo_created
