- job:
    block-downstream: false
    block-upstream: false
    builders:
    - shell: |-
        python3 -m venv ./venv --clear
        source ./venv/bin/activate
        pip install -r ./offline-installer/build/download/requirements.txt
        ./offline-installer/build/download/download.py \
        --docker ${RESOURCES_LIST_DIRECTORY}/rke_docker_images.list \
        --docker ${OOM_DATALIST_FILE} \
        --http ${RESOURCES_LIST_DIRECTORY}/infra_bin_utils.list ${LOCAL_RESOURCES_FOLDER}/downloads \
        --git ${RESOURCES_LIST_DIRECTORY}/onap_git_repos.list ${LOCAL_RESOURCES_FOLDER}/git-repo \
        --npm ${RESOURCES_LIST_DIRECTORY}/onap_npm.list ${LOCAL_RESOURCES_FOLDER}/offline_data/npm_tar \
        --rpm ${RESOURCES_LIST_DIRECTORY}/onap_rpm.list ${LOCAL_RESOURCES_FOLDER}/pkg/rhel \
        --pypi ${RESOURCES_LIST_DIRECTORY}/onap_pip_packages.list ${LOCAL_RESOURCES_FOLDER}/offline_data/pypi

        ./offline-installer/build/download/download.py \
        --docker ${RESOURCES_LIST_DIRECTORY}/infra_docker_images.list ${LOCAL_RESOURCES_FOLDER}/offline_data/docker_images_infra/
        deactivate
    concurrent: false
    description: This job downloads all artifacts based on provided lists
    disabled: false
    display-name: Step 2 Download Artifacts
    name: download_artifacts
    node: rhel_build_server
    parameters:
    - string:
        default: master
        description: ''
        name: GERRIT_REFSPEC
        trim: 'false'
    - string:
        default: /root/onap_generated_docker_images.list
        description: Generated list file of docker images
        name: OOM_DATALIST_FILE
        trim: 'false'
    - string:
        default: ${WORKSPACE}/offline-installer/build/data_lists
        description: ''
        name: RESOURCES_LIST_DIRECTORY
        trim: 'false'
    - string:
        default: ${WORKSPACE}/resources
        description: ''
        name: LOCAL_RESOURCES_FOLDER
        trim: 'false'
    project-type: freestyle
    properties:
    - raw:
        xml: |
          <hudson.plugins.buildblocker.BuildBlockerProperty plugin="build-blocker-plugin@1.7.3">
          <useBuildBlocker>false</useBuildBlocker>
          <blockLevel>GLOBAL</blockLevel>
          <scanQueueFor>DISABLED</scanQueueFor>
          <blockingJobs />
          </hudson.plugins.buildblocker.BuildBlockerProperty>
    - raw:
        xml: |
          <com.sonyericsson.rebuild.RebuildSettings plugin="rebuild@1.29">
          <autoRebuild>false</autoRebuild>
          <rebuildDisabled>false</rebuildDisabled>
          </com.sonyericsson.rebuild.RebuildSettings>
    publishers: []
    scm:
    - raw:
        xml: |
          <scm class="hudson.plugins.git.GitSCM" plugin="git@3.9.1">
          <configVersion>2</configVersion>
          <userRemoteConfigs>
          <hudson.plugins.git.UserRemoteConfig>
          <refspec>$GERRIT_REFSPEC</refspec>
          <url>https://gerrit.onap.org/r/oom/offline-installer</url>
          </hudson.plugins.git.UserRemoteConfig>
          </userRemoteConfigs>
          <branches>
          <hudson.plugins.git.BranchSpec>
          <name>*/master</name>
          </hudson.plugins.git.BranchSpec>
          </branches>
          <doGenerateSubmoduleConfigurations>false</doGenerateSubmoduleConfigurations>
          <submoduleCfg class="list" />
          <extensions>
          <hudson.plugins.git.extensions.impl.CleanBeforeCheckout />
          <hudson.plugins.git.extensions.impl.RelativeTargetDirectory>
          <relativeTargetDir>offline-installer</relativeTargetDir>
          </hudson.plugins.git.extensions.impl.RelativeTargetDirectory>
          <hudson.plugins.git.extensions.impl.BuildChooserSetting>
          <buildChooser class="com.sonyericsson.hudson.plugins.gerrit.trigger.hudsontrigger.GerritTriggerBuildChooser" plugin="gerrit-trigger@2.28.0">
          <separator>#</separator>
          </buildChooser>
          </hudson.plugins.git.extensions.impl.BuildChooserSetting>
          </extensions>
          </scm>
    triggers: []
    wrappers: []
